/*! qui.circularMenu v0.1.3 // jlreymendez Â© 01-22-2012 */
/*! Licensed MIT: https://github.com/jlreymendez/qui/blob/master/License.txt */
(function(b,a){if((!b)||(!b.widget)||(!a)||(!Math)){return false}b.widget("qui.circularMenu",{options:{baseClass:"qui-circularMenu",buttons:[],buttonsOptions:{markup:"<span id='{{id}}' class='{{htmlClass}}'>{{text}}</span>",offset:80,closeOnClick:false,singleEventHandler:true},radius:100,target:""},_create:function(){this.$target=b(this.options.target).eq(0);if(!this.$target.length){return this}this.$target.hide();this.isOpen=false;this.insideClick=false;this.inAnimation=false;this.diameter=this.options.radius*2;this._menuStyling();this._buttonsCreation();this._on({contextmenu:this._evContextMenu,click:this._evClick});this._on(this.$buttons,{click:this._evButtonClick});this.$target.show()},_buttonsCreation:function(){var h,k,c,f,j,g=function(i){console.log(i.target.innerHTML);return this},d;k=a.compile(this.options.buttonsOptions.markup);c=this.options.baseClass?this.options.baseClass+"-button":"";d=Math.PI*2/this.options.buttons.length;this.$buttons=b();for(var e=0;e<this.options.buttons.length;e++){h=b(k.render(this.options.buttons[e]));this.$target.append(h);h.addClass(c).css({position:"absolute",top:this.options.radius-this.options.buttonsOptions.offset*Math.cos(d*e),left:this.options.radius-this.options.buttonsOptions.offset*Math.sin(d*e)});this.$buttons=this.$buttons.add(h);h.data("qui-circularMenu-button",e+1)}this.$buttons.hide()},_close:function(){if(this.inAnimation){return this}this.inAnimation=true;this.$buttons.hide();this.$target.animate({top:this.$target.position().top+this.options.radius,left:this.$target.position().left+this.options.radius,height:0,width:0,"z-index":2},{complete:b.proxy(this._closeComplete,this)})},_closeComplete:function(){this.inAnimation=false;this.isOpen=false},_menuStyling:function(){this.element.css({position:"relative"});this.$target.css({position:"absolute","border-radius":this.options.radius,width:0,height:0}).addClass(this.options.baseClass)},_open:function(d){if(this.inAnimation){return this}var c;this.inAnimation=true;this.$target.css({visibility:"hidden",width:this.diameter,height:this.diameter});this.$target.position({my:"center",of:d,collision:"fit"});c=this.$target.position();this.$target.css({visibility:"visible",top:c.top+this.options.radius,left:c.left+this.options.radius,width:0,height:0});this.$target.animate({top:c.top,left:c.left,width:this.options.radius*2,height:this.options.radius*2},{complete:b.proxy(this._openComplete,this)})},_openComplete:function(){this.inAnimation=false;this.isOpen=true;this.$buttons.show()},_evButtonClick:function(g){var c=b(g.target),d=c.data("qui-circularMenu-button"),f="button"+(this.options.buttonsOptions.singleEventHandler?"":d)+"clicked";this._trigger(f,g,{button:d})},_evClick:function(c){if((!this.isOpen)||(this.insideClick)){this.insideClick=false;return false}this._close(c)},_evContextMenu:function(c){c.preventDefault();if(this.isOpen){this._close(c)}else{this._open(c)}}});b.widget.bridge("circularMenu",b.qui.circularMenu)})(jQuery,Hogan);